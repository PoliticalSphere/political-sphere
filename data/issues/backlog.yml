# Local engineering backlog for Copilot-aware tooling
# Each issue includes enough metadata for automated triage

issues:
  - id: OPS-201
    title: "Tighten API authentication audit logging"
    area: api
    severity: high
    status: in-progress
    owner: "Platform Security"
    tags: [security, logging, compliance]
    summary: >
      We log authentication attempts in three different middlewares but the fields are
      inconsistent and do not include the originating feature flag context. Align the
      structure and ensure sensitive values are hashed.
    hotspots:
      - apps/api/src/auth/auth.middleware.ts
      - apps/api/src/middleware/auth.js
      - apps/api/src/logger.js
    acceptanceCriteria:
      - "Single structured log payload for login + token refresh events"
      - "Feature flag name recorded when auth experiments run"
      - "Secrets (tokens, emails) masked before logging"
    links:
      - type: doc
        path: docs/06-security-and-risk/risk-register.yml

  - id: WEB-148
    title: "Improve civic feed rendering performance"
    area: web
    severity: medium
    status: backlog
    owner: "Civic Experience"
    tags: [performance, web, react]
    summary: >
      Feed rendering in apps/web spikes to 120ms on average because memoization is disabled
      for cards with inline charts. Need profiling data + lightweight virtualization.
    hotspots:
      - apps/web/src/components/feed/CivicFeed.tsx
      - apps/web/src/components/feed/CivicCard.tsx
      - apps/web/src/hooks/useRealtimeFeed.ts
    acceptanceCriteria:
      - "Render 95th percentile frame under 32ms locally"
      - "Add performance vitals test to vitest suite"

  - id: DATA-072
    title: "Document SQLite datasets for assistants"
    area: data
    severity: low
    status: backlog
    owner: "Insights"
    tags: [data, documentation]
    summary: >
      Assistants query the datasets exposed via the SQLite MCP but there is no catalog.
      Need machine-readable metadata and short descriptions for each .db file.
    hotspots:
      - data/README.md
      - tools/mcp-servers/sqlite/index.mjs
    acceptanceCriteria:
      - "Each .db in data/ has a description and owner"
      - "Expose new metadata resource through SQLite MCP"

  - id: AI-311
    title: "Guardrail tests for AI assistant MCP actions"
    area: ai
    severity: high
    status: review
    owner: "AI Platform"
    tags: [ai, testing, governance]
    summary: >
      The AI orchestration scripts in tools/scripts/ai execute MCP actions without regression
      tests. Need snapshot tests for the most sensitive commands before enabling auto-fix.
    hotspots:
      - tools/scripts/ai
      - tools/tests
    acceptanceCriteria:
      - "Add vitest coverage for at least 3 high-risk AI flows"
      - "Document how to run the guardrail suite locally"

  - id: OPS-219
    title: "Stabilize reporting for nightly compliance job"
    area: ops
    severity: medium
    status: in-progress
    owner: "Operations"
    tags: [ops, cron, reporting]
    summary: >
      Nightly compliance summary occasionally produces empty CSVs due to race conditions with
      the data export step. Need deterministic ordering and error retries.
    hotspots:
      - scripts/ci/audit/app-audit-compliance.sh
      - apps/api/scripts/smoke-phase1.ts
    acceptanceCriteria:
      - "Job exits non-zero on missing rows"
      - "Retry with backoff before giving up"
      - "CSV includes generated timestamp in header"
